
= class OpenSSL::PKCS7 < Object

PKCS #7 クラス

PKCS #7 は暗号技術とともに用いられるデータのフォーマットの仕様です。
データやそれに対する署名、証明した日時など任意の属性を含むことができ、S/MIME などに使用されています。
[[rfc:2315]]

== Class Methods

--- new
--- new(str)
--- new(io)
#@todo

PKCS7 オブジェクトを生成します。

--- read_smime(str)
--- read_smime(io)
#@todo

S/MIME 形式を読み込み、PKCS7 オブジェクトを返します。

--- write_smime(p7sig)
--- write_smime(p7sig, data, flags = DETACHED)
#@todo

PKCS7 オブジェクトから S/MIME 形式の文字列を返します。
multipart/signed による平文署名である場合、署名されたデータを data として与えなければなりません。

例:

  data = "hoge"
  p7 = PKCS7.sign( X509::Certificate.new(File.read('cert.pem')),
                   PKey::RSA.new(File.read('privkey.pem')),
                   data)
  smime = PKCS7.write_smime(p7, data)

--- sign(cert, key, data, []= nil, flags = 0)
#@todo

data に証明書 cert を付けて key で署名します。

--- encrypt([rcpt], smime)
#@todo

S/MIME 形式の文字列をメッセージの受け取り手の公開鍵 rcpt を使って暗号化します。

== Instance Methods

--- type
--- type=(type)
#@todo

タイプを [[c:Symbol]] オブジェクトで返します。次のうちのいずれかの値をとります。

:signed, :encrypted, :enveloped, :signedAndEnveloped, :data

--- detached
--- detached=(bool)
#@todo

平文に署名を付ける形式(multipart/signed)かどうかを表します。 type では :signed にあたります。

--- detached?
#@todo

実際に署名されていてかつ平文に署名を付ける形式(multipart/signed)かどうかを返します。

--- cipher=(cipher)
#@todo

使用する暗号アルゴリズムを指定します。

--- add_signer(singer)
#@todo

署名者を加えます。

--- signers
#@todo

メッセージの署名者 OpenSSL::PKCS7::Signer オブジェクトの配列を返します。

--- add_recipient
#@todo

--- add_certificate
#@todo

--- certificates
--- certificates=(certificates)
#@todo

署名に付ける証明書を指定します。

--- add_crl(s)
#@todo

CRL に加えます。

--- crls
--- crls=(s)
#@todo

CRL を返します。

--- add_data(data)
#@todo

署名の対象となるデータに data を加えます。

--- data
--- data=(data)
#@todo

署名の対象となるデータを返します。

--- verify(certs, store, indata = nil, flags = 0)
#@todo

署名を検証します。

--- decrypt(pkey, cert, flags = 0)
#@todo

復号化します。

--- to_pem
--- to_s
#@todo

PEM 形式に変換します。

#@since 1.8.1
--- to_der
#@todo

DER 形式に変換します。
#@end

--- error_string
--- error_string=
#@todo

#@since 1.8.3
--- recipients
#@todo
#@end

== Constants

--- DETACHED
#@todo

平文に署名を付ける形式 (multipart/signed) で行います。 PKCS7.sign において DETACHED がセットされていた時にだけ意味をもちます。

--- TEXT
#@todo

text/plain のためのコンテンツに MIME ヘッダーを加えます。DETACHED ビットが立っている時だけ意味をもちます。

--- BINARY
#@todo

MIME canonical format への変換を行いません。

--- NOATTR
#@todo

署名した時間などの情報を省略します。

--- NOCERTS
#@todo

署名者の証明書を署名に含めません。送り先がすでに証明書をもっている場合、データの量を減らすことができます。

--- NOCHAIN
#@todo

--- NOINTERN
#@todo

--- NOSIGS
#@todo

--- NOSMIMECAP
#@todo

署名者が使用可能な暗号アルゴリズムの情報などを省略します。

--- NOVERIFY
#@todo

= class OpenSSL::PKCS7::PKCS7 < OpenSSL::PKCS7
このクラスは 1.8.6 以前との互換性のために存在します。


#@since 1.8.3
= class OpenSSL::PKCS7::RecipientInfo < Object
== Class Methods
--- new

== Instance Methods

--- enc_key
#@todo

--- issuer
#@todo

--- serial
#@todo
#@end

#@until 1.8.3
= class OpenSSL::PKCS7::Signer < Object
#@else
= class OpenSSL::PKCS7::SignerInfo < Object
#@end

== Class Methods
--- new

== Instance Methods

#@since 1.8.3
--- issuer
#@todo
#@end

--- name
#@todo

--- serial
#@todo

--- signed_time
#@todo

= class OpenSSL::PKCS7::PKCS7Error < OpenSSL::OpenSSLError


