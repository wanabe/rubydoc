= class WIN32OLE_METHOD < Object

OLEオートメーションサーバが持つメソッドの情報を提供します。

WIN32OLE_METHODは、[[m:WIN32OLE#ole_methods]]などの呼び出しによって返されるオブジェクトで、OLEオートメーションサーバのメソッドの情報（メタデータ）を保持します。

=== サンプルコード

   excel = WIN32OLE.new('Excel.Application')
   excel.ole_methods.each do |method|
     if method.visible?
       puts <<SIGNATURE
 #{method.return_type} #{method.name}(#{
     method.params.map {|p| "#{p.ole_type} #{p.name}"}.join(', ')
 }) : #{method.helpstring}
 SIGNATURE
     end
   end


@see [[m:WIN32OLE#ole_methods]]
@see [[m:WIN32OLE#ole_function_methods]]
@see [[m:WIN32OLE#ole_get_methods]]
@see [[m:WIN32OLE#ole_put_methods]]
@see [[m:WIN32OLE#ole_method]]
@see [[m:WIN32OLE#ole_method_help]]
@see [[c:WIN32OLE_PARAM]]

== Class Methods

--- new(ole_type,  method) -> WIN32OLE_METHOD
[[c:WIN32OLE_TYPE]]とメソッド名を指定してWIN32OLE_METHODのインスタンスを生成します。

OLEオートメーションサーバの型情報とメソッド名からWIN32OLE_METHODのインスタンスを生成します。

アプリケーションプログラムでは、WIN32OLE_METHODオブジェクトをnewメソッドで生成するよりも、[[m:WIN32OLE#ole_method]]などのメソッドを参照するほうが簡単です。

@param ole_type [[c:WIN32OLE_TYPE]]のインスタンス。
@param method メソッド名を文字列で指定します。
@return methodパラメータに対応するWIN32OLE_METHODのインスタンス。
@raise WIN32OLERuntimeError methodパラメータで指定したメソッドが見つかりません。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SaveAs')

== Instance Methods

--- dispid -> Integer
メソッドのディスパッチID（DISPID）を取得します。

ディスパッチIDはメソッドの一意識別子です。WIN32OLEでは、[[m:WIN32OLE#_invoke]]などのメソッドで、呼び出すサーバのメソッドを指定するのに利用します。

@return メソッドのDISPIDを返します。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.dispid # => 181

@see [[m:WIN32OLE#_invoke]]
@see [[m:WIN32OLE#_getproperty]]
@see [[m:WIN32OLE#_setproperty]]

--- event? -> bool
メソッドがイベントかどうかを取得します。

イベントとはこのサーバが実装しているメソッドではなく、クライアント側がサーバ側の通知を受けるために実装するメソッドです。

@return メソッドがイベントであれば真。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SheetActivate')
   puts method.event? # => true

@see [[c:WIN32OLE_EVENT]]

--- event_interface
#@todo

Returns event interface name if the method is event.

  tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
  method = WIN32OLE_METHOD.new(tobj, 'SheetActivate')
  puts method.event_interface # =>  WorkbookEvents

--- helpcontext
#@todo

Returns help context.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.helpcontext # => 65717

--- helpfile
#@todo

Returns help file. If help file is not found, then the method
returns nil.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.helpfile # => C:\...\VBAXL9.CHM

--- helpstring
#@todo

Returns help string of OLE method. If the help string is not
found, then the method returns nil.

   tobj = WIN32OLE_TYPE.new('Microsoft Internet Controls', 'IWebBrowser')
   method = WIN32OLE_METHOD.new(tobj, 'Navigate')
   puts method.helpstring # => Navigates to a URL or file.

--- invkind
#@todo

Returns the method invoke kind.

  tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
  method = WIN32OLE_METHOD.new(tobj, 'Add')
  puts method.invkind # => 1

--- invoke_kind
#@todo

Returns the method kind string. The string is "UNKNOWN" or "PROPERTY"
or "PROPERTY" or "PROPERTYGET" or "PROPERTYPUT" or "PROPERTYPPUTREF"
or "FUNC".

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.invoke_kind # => "FUNC"

--- name -> String
--- to_s -> String
メソッド名を取得します。

@return メソッド名を文字列で返します。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SaveAs')
   puts method.name # => SaveAs

--- offset_vtbl -> Integer
このメソッドのVTBLのオフセットを取得します。

VTBLはC++やCでメソッドを呼び出すために利用する関数ポインタのテーブルです。

@return メソッドのVTBL上のオフセットを返します。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.offset_vtbl # => 40

--- params -> [WIN32OLE_PARAM]
メソッドのパラメータ情報を取得します。

このメソッドのパラメータを[[c:WIN32OLE_PARAM]]の配列として返します。配列の最初の要素が最左端のパラメータに対応します。

@return [[c:WIN32OLE_PARAM]]の配列。無引数のメソッドであれば要素数0の配列を返します。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SaveAs')
   p method.params # => [Filename, FileFormat, Password, WriteResPassword,
                         ReadOnlyRecommended, CreateBackup, AccessMode,
                         ConflictResolution, AddToMru, TextCodepage,
                         TextVisualLayout]

--- return_type
#@todo

Returns string of return value type of method.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.return_type # => Workbook

--- return_type_detail
#@todo

Returns detail information of return value type of method. The
information is array.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   p method.return_type_detail # => ["PTR", "USERDEFINED", "Workbook"]

--- return_vtype
#@todo

Returns number of return value type of method.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.return_vtype # => 26

--- size_opt_params
#@todo

Returns the size of optional parameters.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SaveAs')
   puts method.size_opt_params # => 4

--- size_params
#@todo

Returns the size of arguments of the method.

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbook')
   method = WIN32OLE_METHOD.new(tobj, 'SaveAs')
   puts method.size_params # => 11


--- visible? -> bool
このメソッドがクライアントに対して公開されているか（可視性を持つか）どうかを返します。

@return メソッドが公開されていれば真。

   tobj = WIN32OLE_TYPE.new('Microsoft Excel 9.0 Object Library', 'Workbooks')
   method = WIN32OLE_METHOD.new(tobj, 'Add')
   puts method.visible? # => true

